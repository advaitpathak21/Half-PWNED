- ![](/attachments/Pasted-image-20250924211257.png)
## Access Tokens
- https://docs.microsoft.com/en-us/windows/win32/secauthz/access-tokens
- ![](/attachments/Pasted-image-20250924211421.png)
## Enumerating Network Services
- most common way people interact with processes is through a network socket (DNS, HTTP, SMB, etc.).
- we can find a service running only for localhost
- `netstat -ano`
- look for entries listening on loopback addresses (`127.0.0.1` and `::1`)
	- The reason for this is network sockets on localhost are often insecure due to the thought that "they aren't accessible to the network."
- The one that sticks out immediately will be port `14147`, which is used for FileZilla's administrative interface. By connecting to this port, it may be possible to extract FTP passwords in addition to creating an FTP Share at c:\ as the FileZilla Server user (potentially Administrator).
- eg: [Splunk Universal Forwarder Hijacking](https://airman604.medium.com/splunk-universal-forwarder-hijacking-5899c3e0e6b2) and [SplunkWhisperer2](https://clement.notin.org/blog/2019/02/25/Splunk-Universal-Forwarder-Hijacking-2-SplunkWhisperer2/).
	-  [Erlang-arce blogpost from Mubix](https://malicious.link/post/2018/erlang-arce/)
- ![](/attachments/Pasted-image-20250924211741.png)
## Named Pipes
- ![](/attachments/Pasted-image-20250924211939.png)
- ![](/attachments/Pasted-image-20250924212106.png)
### Pipelist - Listing Named Pipes
- https://docs.microsoft.com/en-us/sysinternals/downloads/pipelist
- List named pipes
	- `pipelist.exe /accepteula`
	- `gci \\.\pipe\` - **PowerShell**
- Enum pipe permissions - [Accesschk](https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk)
	- `accesschk.exe /accepteula \\.\Pipe\lsass -v`
		- checking pipe permissions for `LSASS`
	- If named pipe in `\\.\pipe\lsass` use the whole path like above
	- If named pipe in `\\.\pipe\SQLLocal\SQLExpress01`, 
		- `accesschk.exe /accepteula \pipe\SQLLocal\SQLExpress01 -v`
## Named Pipes Attack Example 
- This [WindscribeService Named Pipe Privilege Escalation](https://www.exploit-db.com/exploits/48021)
- search all named pipes that allow write access
	- `accesschk.exe -w \pipe\* -v`
		- `WindscribeService` named pipe allows `READ` and `WRITE` access to the `Everyone` group
	- 
